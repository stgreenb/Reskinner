<!-- OPENSPEC:START -->
# OpenSpec Instructions

These instructions are for AI assistants working in this project.

Always open `@/openspec/AGENTS.md` when the request:
- Mentions planning or proposals (words like proposal, spec, change, plan)
- Introduces new capabilities, breaking changes, architecture shifts, or big performance/security work
- Sounds ambiguous and you need the authoritative spec before coding

Use `@/openspec/AGENTS.md` to learn:
- How to create and apply change proposals
- Spec format and conventions
- Project structure and guidelines

Keep this managed block so 'openspec update' can refresh the instructions.

<!-- OPENSPEC:END -->

## Critical: Foundry VTT Module Validation

**Every implementation must validate that all files referenced in `module.json` exist and are properly built:**

- [ ] **Check `esmodules` entries** (e.g., `ds-reskinner.mjs`) are generated by build process
- [ ] **Check `styles` entries** (e.g., `css/module.css`) are available  
- [ ] **Check `templates` entries** exist in correct directory structure
- [ ] **Check `languages` entries** exist and are properly formatted
- [ ] **Run build process**: `npm run build` to generate required files
- [ ] **Validate file paths**: Ensure all paths in `module.json` match actual file locations
- [ ] **Test module loading**: Verify Foundry VTT can load the module without metadata validation errors

**Common Issues & Solutions:**
- **Missing `ds-reskinner.mjs`** → Run `npm run build` 
- **Build tool dependency conflicts** → Check `package.json` and fix incompatible versions
- **Missing CSS/Template files** → Verify rollup copy configuration
- **Path misalignment** → Update module.json to match generated file structure

**Learned from Experience**: The error `"Metadata validation failed for module "ds-reskinner": The file "ds-reskinner.mjs" included by module ds-reskinner does not exist"` occurred because the build process wasn't run to generate the bundled JavaScript file that Foundry VTT expects.

**Important Version Tracking Practice**: Each iteration of development should update version numbers in all relevant locations (`module.json`, `package.json`, and optionally source code comments/logs) to ensure clear identification of which version is running during testing and troubleshooting. This helps avoid confusion when diagnosing issues as you can clearly see which version of the codebase is running on the server.

Note USER will upload the module to Foundry VTT, so we must ensure all files are properly built and referenced and wait for the user to confirm the server has been updated and restarted. 